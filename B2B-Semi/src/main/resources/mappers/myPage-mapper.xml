<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper
	namespace="edu.kh.project.myPage.model.mapper.MyPageMapper">

	<!-- 회원정보 수정 -->
	<update id="editInfo" parameterType="Member">
		UPDATE "TB_MEMBER" SET
		MEMBER_NICKNAME = #{memberNickname},
		MEMBER_TEL = #{memberTel},
		MEMBER_BOOK_CATEGORY = #{memberBookCategory},
		MEMBER_ADDRESS =
		#{memberAddress}
		WHERE MEMBER_NO = #{memberNo}
	</update>



	<!-- 프로필 이미지 변경 -->
	<update id="profileImageInfo">
		UPDATE "TB_MEMBER" SET
		PROFILE_IMG = #{profileImg}
		WHERE MEMBER_NO = #{memberNo}
	</update>




	<!-- 찜한 도서 목록 조회 -->
	<select id="selectFavoriteBooks">
		SELECT b.BOOK_ID, b.TITLE, b.AUTHOR, b.COVER_URL,
		b.CUSTOMER_REVIEW_RANK
		FROM TB_FAVORITE f
		JOIN TB_BOOKS b ON f.BOOK_ID =
		b.BOOK_ID
		WHERE f.MEMBER_NO = #{memberNo}
	</select>



	<!-- 작성자의 전체 게시글 수 조회 -->
	<select id="getBoardListCount" resultType="int">
		SELECT COUNT(*)
		FROM
		"TB_BOARD"
		WHERE MEMBER_NO = #{memberNo}
	</select>



	<!-- 사용자가 작성한 전체 게시글 목록 조회 -->
	<select id="selectAllBoardList" resultType="Board">
	    SELECT 
	    b.BOARD_NO, 
	    b.BOARD_TITLE, 
	    b.BOARD_CONTENT, 
	    b.BOARD_WRITE_DATE, 
	    b.BOARD_UPDATE_DATE, 
	    b.READ_COUNT, 
	    b.BOARD_CODE,
	    m.MEMBER_NICKNAME AS MEMBER_NICKNAME
	FROM "TB_BOARD" b
	JOIN "TB_MEMBER" m ON b.MEMBER_NO = m.MEMBER_NO
	WHERE b.MEMBER_NO = #{memberNo}
	ORDER BY b.BOARD_NO DESC
	</select>


	<select id="selectAllCommentList" resultType="Comment">
		SELECT
		c.COMMENT_NO,
		c.COMMENT_TEXT,
		c.COMMENT_DEL_FL,
		c.COMMENT_REGI_DATE,
		c.PARENT_COMMENT_NO,
		m.MEMBER_NICKNAME AS MEMBER_NICKNAME	
		FROM "TB_COMMENT" c
		JOIN TB_MEMBER m ON c.MEMBER_NO = m.MEMBER_NO
		WHERE c.MEMBER_NO = #{memberNo}
		ORDER BY c.COMMENT_NO DESC
	</select>























	<!-- 비밀번호 조회 -->
	<select id="selectPw">
		SELECT MEMBER_PW
		FROM "TB_MEMBER"
		WHERE MEMBER_NO =
		#{memberNo}
	</select>


	<!-- 비밀번호 변경 -->
	<update id="changePw">
		UPDATE "TB_MEMBER" SET
		MEMBER_PW = #{encPw}
		WHERE
		MEMBER_NO = #{memberNo}
	</update>







</mapper>
